<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Site Map Graph</title>
    <script type="text/javascript" src="https://visjs.github.io/vis-network/standalone/umd/vis-network.min.js"></script>
    <style type="text/css">
        html, body {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: #1e1e1e;
        }
        #mynetwork {
            width: 100%;
            height: 100%;
        }
    </style>
</head>
<body>
<div id="mynetwork"></div>
<script type="text/javascript">
    var container = document.getElementById('mynetwork');
    var nodes = new vis.DataSet([]);
    var edges = new vis.DataSet([]);
    var data = { nodes: nodes, edges: edges };

    var options = {
        nodes: {
            shape: 'dot',
            size: 20,
            font: {
                color: '#ffffff',
                size: 14,
                face: 'Segoe UI'
            },
            borderWidth: 2,
            shadow: true
        },
        edges: {
            width: 1.5,
            color: { color: '#666666', highlight: '#00ccff' },
            arrows: { to: { enabled: true, scaleFactor: 0.5 } },
            smooth: { type: 'cubicBezier', forceDirection: 'horizontal', roundness: 0.4 }
        },
        physics: {
            stabilization: false,
            solver: 'forceAtlas2Based',
            forceAtlas2Based: {
                gravitationalConstant: -80,
                centralGravity: 0.005,
                springLength: 250,
                springConstant: 0.1,
                damping: 0.5
            },
            minVelocity: 0.75
        },
        groups: {
            INTERNAL: { color: { background: '#007acc', border: '#005f9e' } },
            EXTERNAL: { color: { background: '#ff9800', border: '#e65100' }, shape: 'diamond', size: 25 },
            GROUPED:  { color: { background: '#9c27b0', border: '#7b1fa2' }, shape: 'hexagon', size: 30 },
            PENDING:  { color: { background: '#333333', border: '#aaaaaa' }, shape: 'dot' }
        },
        interaction: {
            hover: true,
            tooltipDelay: 200,
            zoomView: true
        }
    };

    var network = new vis.Network(container, data, options);

    network.on("click", function (params) {
        if (params.nodes.length > 0) {
            var nodeId = params.nodes[0];
            if (window.javaConnector) {
                window.javaConnector.onNodeSelected(nodeId);
            } else {
                console.log("JavaConnector object not found");
            }
        }
    });

    function updateGraph(nodeData, edgeData) {
        if (nodeData) {
            try {
                var nodeObj = JSON.parse(nodeData);
                nodes.update(nodeObj);
            } catch(e) { }
        }
        if (edgeData) {
            try {
                var edgeObj = JSON.parse(edgeData);
                var existing = edges.get({
                    filter: function (item) {
                        return item.from === edgeObj.from && item.to === edgeObj.to;
                    }
                });
                if (existing.length === 0) {
                    edges.add(edgeObj);
                }
            } catch(e) { }
        }
    }

    function clearGraph() {
        nodes.clear();
        edges.clear();
    }
</script>
</body>
</html>